ASMB,R,B,L,X
      NAM TIMFN,7 
      SPC 2 
      ENT TIMFN 
      SPC 2 
      COM PBPTR,NEG(26),.(52),MAIN,SPROG,SYMTB,ERRCT
      COM SBPTR,SBUFA,SSTAK,SYNTQ,SERRS(36),RERRS(50) 
      COM FERRS(15),WERRS(10),MAXCR,MSFLG,PFLAG,SFLAG 
      COM DFLAG,TEMP(3),CDFLG,ARYAD,GFLAG,SIGN,UFLAG
      COM PINTG(2),TABLE,LNGTH,SMBGN,SLENG,COUNT
      COM TBLPT,TSPTR,SBT0
      COM EXP,MANT1,MANT2,EXPON,DPFLG,NT0,ENOUF 
      COM LNAME,CHRCT,OCTMP,SPTR,FILTB,NSPTR,INFST
      COM DCLC1,DEST,DCLC2,STEND,DFILT,FILPT,COMSN
      COM MVEND 
      COM STYPE,USESN,FILCT,.LNUM 
      COM PRGCT,STCT1,STCT2,NUMPT,STCT3,FLINK 
      COM STMP1,STMP2,VLFLG,VALTB,FCORE,COMPT,VTMP1 
      COM VTMP2,VTMP3,VTMP4,VTMP5,IFSS
      COM CU1,APTR,DCFLG,TEMP2,LT1,LT2,FCNTR,RTNST
      COM ASINP,RTRNQ,FORQ,TEMP1,FILE#
      COM INTMP,TMPST,TPRME,TNULL,PS1,DMY3,TEMP5
      COM PRIST,FBASE,RQ3,EOL,GTMP,FORST,EFN0,FVT 
      COM EFN1,EFN2,EFN3,MCNT,INITF,IFCNT,OPDST 
      COM FFLG,TEMP4,EORFL,NCH,TEMP6,STRLN,ATIM,LT5 
      COM ASTYP,ASBFP,ORDNO,ATMP(2),RETCD 
      COM DCCNT,NXTDT,VL0,RCRD#,PMASK,ITEMP 
      COM OPTRQ,EST3,EST2,EST1,TT1,TT2,DMY1 
      COM DMY2,TT3,TT4,CP0,CP1,PS0,MPT,NQT,RT0
      COM RT1,TRFCH,TRS0,A1,A2,C1,EOPF,NUMBF(6),FD0 
      COM OT1,OT2,OT3,LBTMP,REPCT,RNDX1,RNDX2 
      COM X2TMP(2),CTMP,DTMP(2),BTMP(2),XTEMP(2),YTEMP(2) 
      COM UTEMP(2),LT0,LT8,LT3,LT6,LT7,LT4,DIGCT
      COM NMPTR,NMTMP,FFLAG,DGCNT 
      COM IFSTR,EC,CC,DP,CONTR,CC1,CC2,PC1,PC2
      COM SFLG,FST,EFLAG,NUM1,NUM2,SBD,SAD,SNFLG
      COM NAD,NBD,FSP,EST,NUMW1,NUMW2,EXPW
      COM IHB,HBP,NHBW,NBLK,TOTDG,DCTR
      COM EDSTA,LCH,ELCNT 
      COM STPTR,RSPTR,TEMP3 
      COM MT1,MT0,MT3,MT2,MEXIT,DMY4,MOP,BS2,BS3
      COM MMT0,MMT1,MMT2,MMT6(2),MMT7(2),MMT3,MMT4,MMT5 
      COM MMT8(2),SCALR(2),ID0,ID1,MAXE(2),TOL(2),PIVEL 
      COM VT0,RD0 
      COM SOURC,TAP0,TAP1 
      COM STIME(5)
      COM LTEMP(16),LTYP1,LTYP2,LCHCR,MOVES,MOVED 
      COM ERSEC(77) 
      SPC 2 
      EXT #IFIX 
      EXT SCHEQ 
      EXT EXEC
      SPC 2 
TIMFN NOP 
      JSB #IFIX 
      JSB RERRS+43,I
      SZA 
      JSB RERRS+43,I
      LDA 1 
      AND .+3 
      CPA 1 
      RSS 
      JSB RERRS+43,I
      ADA DTMTB 
      JMP 0,I 
      SPC 1 
DTMTB DEF *+1,I 
      DEF ETIM0 
      DEF ETIM1 
      DEF ETIM2 
      DEF ETIM3 
      SPC 1 
ETIM0 JSB GTIM1 
      LDA ETIME+2 
      JMP TIMFN,I 
      SPC 1 
ETIM1 JSB GTIM1 
      LDA ETIME+3 
      JMP TIMFN,I 
      SPC 1 
ETIM2 LDA GTFLG 
      SZA,RSS 
      JSB GTIM2 
      LDA DAY 
      JMP TIMFN,I 
      SPC 2 
ETIM3 LDA GTFLG 
      SZA,RSS 
      JSB GTIM2 
      LDA YEAR
      JMP TIMFN,I 
      SPC 2 
GTIM3 LDA DATE
      ALF,ALF 
      AND =B17
      MPY =D10
      STA 1 
      LDA DATE
      AND =B17
      ADA 1 
      MPY =D10
      STA 1 
      LDA DATE+1
      ALF,ALF 
      AND =B17
      ADA 1 
      STA DAY 
      LDA DATE+2
      ALF,ALF 
      AND =B17
      MPY =D10
      STA 1 
      LDA DATE+2
      AND =B17
      ADA 1 
      STA YEAR
      JMP GTIM2,I 
      SPC 2 
GTIM1 NOP 
      JSB EXEC
      DEF *+3 
      DEF .+11
      DEF ETIME 
      JMP GTIM1,I 
      SPC 1 
GTIM2 NOP 
      ISZ GTFLG 
      LDA 115B
      STA 1 
      AND =B377 
      STA DSECT 
      LDA 1 
      ALF,ALF 
      AND =B377 
      STA DTRAK 
      JSB EXEC
      DEF *+7 
      DEF .-1 
      DEF B102
      DEF ERSEC 
      DEF D77 
      DEF DTRAK 
      DEF DSECT 
      JMP GTIM3 
      SPC 2 
DAY   NOP 
YEAR  NOP 
GTFLG OCT 0 
ETIME EQU LTEMP 
DATE  EQU ERSEC+72
DSECT EQU LTEMP+5 
DTRAK EQU LTEMP+6 
B102  OCT 102 
D77   DEC 77
      END TIMFN 
