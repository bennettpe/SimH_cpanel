ASMB,R,B,L,X
      NAM LENGT,5 
      SPC 2 
      COM PBPTR,NEG(26),.(52),MAIN,SPROG,SYMTB,ERRCT
      COM SBPTR,SBUFA,SSTAK,SYNTQ,SERRS(36),RERRS(50) 
      COM FERRS(15),WERRS(10),MAXCR,MSFLG,PFLAG,SFLAG 
      COM DFLAG,TEMP(3),CDFLG,ARYAD,GFLAG,SIGN,UFLAG
      COM PINTG(2),TABLE,LNGTH,SMBGN,SLENG,COUNT
      COM TBLPT,TSPTR,SBT0
      COM EXP,MANT1,MANT2,EXPON,DPFLG,NT0,ENOUF 
      COM LNAME,CHRCT,OCTMP,SPTR,FILTB,NSPTR,INFST
      COM DCLC1,DEST,DCLC2,STEND,DFILT,FILPT,COMSN
      COM MVEND 
      COM STYPE,USESN,FILCT,.LNUM 
      COM PRGCT,STCT1,STCT2,NUMPT,STCT3,FLINK 
      COM STMP1,STMP2,VLFLG,VALTB,FCORE,COMPT,VTMP1 
      COM VTMP2,VTMP3,VTMP4,VTMP5,IFSS
      COM CU1,APTR,DCFLG,TEMP2,LT1,LT2,FCNTR,RTNST
      COM ASINP,RTRNQ,FORQ,TEMP1,FILE#
      COM INTMP,TMPST,TPRME,TNULL,PS1,DMY3,TEMP5
      COM PRIST,FBASE,RQ3,EOL,GTMP,FORST,EFN0,FVT 
      COM EFN1,EFN2,EFN3,MCNT,INITF,IFCNT,OPDST 
      COM FFLG,TEMP4,EORFL,NCH,TEMP6,STRLN,ATIM,LT5 
      COM ASTYP,ASBFP,ORDNO,ATMP(2),RETCD 
      COM DCCNT,NXTDT,VL0,RCRD#,PMASK,ITEMP 
      COM OPTRQ,EST3,EST2,EST1,TT1,TT2,DMY1 
      COM DMY2,TT3,TT4,CP0,CP1,PS0,MPT,NQT,RT0
      COM RT1,TRFCH,TRS0,A1,A2,C1,EOPF,NUMBF(6),FD0 
      COM OT1,OT2,OT3,LBTMP,REPCT,RNDX1,RNDX2 
      COM X2TMP(2),CTMP,DTMP(2),BTMP(2),XTEMP(2),YTEMP(2) 
      COM UTEMP(2),LT0,LT8,LT3,LT6,LT7,LT4,DIGCT
      COM NMPTR,NMTMP,FFLAG,DGCNT 
      COM IFSTR,EC,CC,DP,CONTR,CC1,CC2,PC1,PC2
      COM SFLG,FST,EFLAG,NUM1,NUM2,SBD,SAD,SNFLG
      COM NAD,NBD,FSP,EST,NUMW1,NUMW2,EXPW
      COM IHB,HBP,NHBW,NBLK,TOTDG,DCTR
      COM EDSTA,LCH,ELCNT 
      COM STPTR,RSPTR,TEMP3 
      COM MT1,MT0,MT3,MT2,MEXIT,BS1,MOP,BS2,BS3 
      COM MMT0,MMT1,MMT2,MMT6(2),MMT7(2),MMT3,MMT4,MMT5 
      COM MMT8(2),SCALR(2),ID0,ID1,MAXE(2),TOL(2),PIVEL 
      COM VT0,RD0 
      COM SOURC,TAP0,TAP1 
      COM STIME(5)
      COM LTEMP(16) 
      SPC 2 
      EXT PBUFF,MLINB,OUTCH,LTYPE,SCHEQ 
      SPC 2 
LENGT LDA PBPTR    GET END-OF-PROG. POINTER 
      CPA PBUFF    NULL?
      JMP LEN1     YES. 
      LDB MLINB    NO.
      ADB .+?FLAG-?LINK 
      LDA 1,I 
      AND CFLAG 
      SZA,RSS      COMPILED?
      JMP LEN1     NO.
      LDA SYMTB    YES.USE SOURCE PROG. POINTER 
      RSS 
LEN1  LDA PBPTR    COMPUTE LENGTH IN WORDS
      CMA 
      ADA SPROG 
      CMA 
      SSA 
      CLA 
      STA LTEMP 
      LDA .+12B 
      JSB OUTCH 
      LDA .-2 
      STA LTEMP+1 
      LDA LTEMP 
      CLB 
      DIV .100
      STB LTEMP 
LEN2  CLB 
      DIV .+10
      STB LTEMP+2 
      ADA .+60B 
      JSB OUTCH 
      LDA LTEMP+2 
      ADA .+60B 
      JSB OUTCH 
      LDA LTEMP 
      ISZ LTEMP+1 
      JMP LEN2
      LDA .-6 
      LDB WORDA 
      JSB LTYPE 
      JMP SCHEQ 
      SPC 2 
?FLAG EQU 0 
?LINK EQU 15B 
CFLAG EQU .+2 
.100  DEC 100 
WORDA DEF *+1 
      ASC 3, WORDS
      END LENGT 
