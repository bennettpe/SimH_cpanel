STA1   000120 
LOOP5  000133 
LOOP4  000135 
LOOP3  000137 
LOOP6  000165 
LOOP7  000202 
LOOP1  000211 
LOOP2  000220 
CHECK  000230 
ALIGN  000241 
LOOP9  000243 
OTA2   000244 
START  000251 
STC1   000252 
LOOP8  000255 
OTA1   000256 
DMAC1  000002 
DMAD1  000006 
DMA2   000263 
CW1    000301 
CW2    000302 
CW3    000303 
OTA    000304 
STCC   000305 
STA    000306 
C127   000307 
C255   000310 
C256   000311 
X5Y0   000312 
X0Y5   000313 
YLSB   000314 
VMARI  000315 
VMAR   000316 
MARK   000317 
MARKI  000320 
MCNT   000321 
PCNT   000322 
MC     000323 
PC     000324 
HMAR   000325 
HMARI  000326 
VHCNT  000327 
VH     000330 
X5Y5   000331 
MYLSB  000332 
XYLSB  000333 
X9Y9   000334 
LAST   000335 
VHO    000336 
TRAP   000337 
MASK   000340 
LOC    000341 
NEXTM  000342 
XLSB   000343 
STORE  000344 
SAVE   000345 
BUFF   000346 
                      HED 1300 TEST PATTERN GENERATOR 12/4/70 
* 
* 
*TEST PATTERN GENERATOR FOR HP-1300 SCOPE INTERFACE 
* 
*STARTING OCTAL ADDRESS = 100B
* 
*CONVERTER INTERFACE CARD AND PUSH RUN ON COMPUTER
* 
* 
* 
* 
*SET SWITCH REGISTER TO OCTAL I/O LOCATION OF D/A 
*THE FOLLOWING SWITCH REGISTER SETTINGS 
*ARE USED FOR PROGRAM CONTROL AFTER COMPUTER HALTS
*WITH "T" REGISTER = 102033 
* 
* 
*   BIT 0 = 1 --ALIGNMENT TEST PATTERN IS DISPLAYED.
*               THE HP 1300 SCOPE IS CALIBRATED 
*               AND ALIGNED FOR FULL SCALE WITH 
*               THIS TEST PATTERN.
*               HP 1300 SCOPE INTERFACE SPECS AND 
*               ALIGNMENT ARE CHECKED IN THIS MODE. 
* 
*   BIT 1 = 1 --VERTICAL AND HORIZONAL TEST PATTERN 
*               IS DISPLAYED UNDER INTERRUPT. 
* 
*   BIT 2 = 1 --ALIGNMENT TEST PATTERN IS DISPLAYED 
*               UNDER DMA CONTROL(IF DMA OPTION IS
*               IN COMPUTER). 
* 
* 
*MAIN PROGRAM 
* 
  00100               ORG 100B
  00100 106700        CLC 0 
* 
*INITIALIZE I/O LOC & TRAP CELL 
* 
  00101 102501        LIA 1B       I/O LOC FROM SW. REG.
  00102 010340        AND MASK
  00103 070341        STA LOC 
  00104 020304        XOR OTA 
  00105 070244        STA OTA2
  00106 070256        STA OTA1
  00107 060341        LDA LOC 
  00110 020305        XOR STCC
  00111 070252        STA STC1
  00112 060341        LDA LOC 
  00113 070301        STA CW1      INITIALIZE DMA CONTROL WORD
  00114 060341        LDA LOC       INITIALIZE
  00115 020306        XOR STA       INTERRUPT 
  00116 070120        STA STA1         TRAP CELL
  00117 060337        LDA TRAP           TO 
  00120 070000  STA1  STA 0                JUMP CHECK 
* 
*LOAD BUFFER WITH POINTS FOR TEST PATTERN 
* 
  00121 060345        LDA SAVE     FIRST ADDRESS OF BUFFER
  00122 070344        STA STORE 
* 
*   GENERATE VERTICAL & HORIZONTAL MARKS
* 
  00123 060327        LDA VHCNT 
  00124 070330        STA VH       COUNTER
  00125 060316        LDA VMAR     INITIALIZE 
  00126 070317        STA MARK       VERTICAL 
  00127 060314        LDA YLSB         MARKS
  00130 070320        STA MARKI          PARAMETERS 
  00131 060315        LDA VMARI 
  00132 070342        STA NEXTM    NEXT MARK
  00133 060323  LOOP5 LDA MC       8 MARKS PER LINE 
  00134 070321        STA MCNT     MARK COUNTER 
  00135 064324  LOOP4 LDB PC       POINT COUNTER
  00136 060317        LDA MARK     FIRST POINT IN MARK
  00137 170344  LOOP3 STA STORE,I  PUT POINT IN BUFFER
  00140 040320        ADA MARKI    NEXT POINT IN MARK 
  00141 034344        ISZ STORE    BUMP ADDRESS 
  00142 034001        ISZ 1        BUMP COUNTER 
  00143 024137        JMP LOOP3    GENERATE NEXT POINT
  00144 060317        LDA MARK     INITIALIZE 
  00145 040342        ADA NEXTM      FIRST POINT
  00146 070317        STA MARK          OF NEXT MARK
  00147 034321        ISZ MCNT     MARKS COMPLETE?
  00150 024135        JMP LOOP4    NO 
  00151 060325        LDA HMAR     INITIALIZE 
  00152 070317        STA MARK       PARAMETERS 
  00153 060326        LDA HMARI         FOR 
  00154 070342        STA NEXTM         GENERATING
  00155 060343        LDA XLSB             HORIZONTAL 
  00156 070320        STA MARKI              MARKS
  00157 034330        ISZ VH       VERT.& HOR MARKS COMPLETE? 
  00160 024133        JMP LOOP5    NO 
* 
*   GENERATE DIAGONAL LINE (CENTER OUT) 
* 
  00161 060307        LDA C127
  00162 070330        STA VH       DIAGONAL COUNTER 
  00163 060331        LDA X5Y5     COUNTER UPPER LEFT HALF
  00164 064331        LDB X5Y5     COUNTER LOWER RIGHT HALF 
  00165 040314  LOOP6 ADA YLSB     INCREMENT Y
  00166 003004        CMA,INA 
  00167 003000        CMA          DECREMENT X
  00170 170344        STA STORE,I  STORE UP POINT 
  00171 034344        ISZ STORE    BUMP ADDRESS 
  00172 044332        ADB MYLSB    DECREMENT Y
  00173 006004        INB          INCREMENT X
  00174 174344        STB STORE,I  STORE DOWN POINT 
  00175 034344        ISZ STORE    BUMP BUFFER ADDRESS
  00176 034330        ISZ VH       DIAGONAL POINTS COMPLETE?
  00177 024165        JMP LOOP6    NO 
* 
*   GENERATE DIAGONAL LINE (TOP OF BOTTOM LEFT) 
* 
  00200 064310        LDB C255     COUNTER
  00201 060334        LDA X9Y9     UPPER RIGHT POINT
  00202 170344  LOOP7 STA STORE,I  PUT POINT IN BUFFER
  00203 040333        ADA XYLSB    X AXIS-1,Y AXIS-1
  00204 034344        ISZ STORE    BUMP BUFFER ADDRESS
  00205 034001        ISZ 1B       ALL POINTS STORED? 
  00206 024202        JMP LOOP7    NO 
* 
*   GENERATE VERTICAL LINE POINTS 
* 
  00207 064311        LDB C256     POINT COUNTER
  00210 060312        LDA X5Y0     FIRST VERT. POINT
  00211 170344  LOOP1 STA STORE,I  PUT POINT IN BUFFER
  00212 040314        ADA YLSB     NEXT POINT 
  00213 034344        ISZ STORE    BUMP BUFFER ADDRESS
  00214 034001        ISZ 1B       ALL POINTS STORED? 
  00215 024211        JMP LOOP1    NO 
* 
*   GENERATE HORIZONTAL LINE POINTS 
* 
  00216 064311        LDB C256     POINT COUNTER
  00217 060313        LDA X0Y5     FIRST HOR. POINT 
  00220 170344  LOOP2 STA STORE,I  PUT POINT IN BUFFER
  00221 002004        INA          NEXT POINT 
  00222 034344        ISZ STORE    BUMP BUFFER ADDRESS
  00223 034001        ISZ 1B       ALL POINTS STORED? 
  00224 024220        JMP LOOP2    NO 
  00225 060335        LDA LAST     LAST POINT = 000000
  00226 170344        STA STORE,I  STORE IN END OF BUFFER 
* 
*   ALL POINTS FOR TEST PATTERN 
*   ARE NOW STORED IN BUFFER
* 
  00227 102033        HLT 33B      STOP TO EXERSIZE OPTIONS 
  00230 102501  CHECK LIA 1B       CHECK REGISTER BIT "0" 
  00231 000010        SLA          TEST BIT 0 
  00232 024241        JMP ALIGN     TEST PATTERN SELECT 
  00233 001100        ARS 
  00234 000010        SLA           CHECK SWITCH BIT 1
  00235 024251        JMP START    VER AND HOR LINES SELECTED 
  00236 001100        ARS 
  00237 000010        SLA          CHECK SWITCH BIT 2 
  00240 024263        JMP DMA2     DMA DRIVER SELECTED
* 
*ALIGNMENT TEST PATTERN DRIVER
*   VERIFY THAT ALIGNMENT IS PROPER BY OBSERVING
*   TEST PATTERN DISPLAYED ON HP1300 SCOPE
* 
  00241 107700  ALIGN CLC 0,C      NON-INTERRUPT
  00242 064345        LDB SAVE     TEST PATTERN BUFFER ADDRESS
  00243 160001  LOOP9 LDA 1,I      GET DATA POINTS FROM BUFFER
  00244 102600  OTA2  OTA 0        OUTPUT DATA TO SCOPE 
  00245 006004        INB          BUMP BUFFER ADDRESS
  00246 002002        SZA          TEST FOR LAST WORD (0) 
  00247 024243        JMP LOOP9    NEXT POINT 
  00250 024230        JMP CHECK    CHECK OPTION BEFORE NEXT OUTPUT
* 
*VERTICAL AND HORIZONTAL LINE TEST PATTERN DRIVER 
*   DISPLAYING UNDER INTERRUPT
* 
  00251 102100  START STF 0 
  00252 103700  STC1  STC 0,C     START REFRESH TIMER 
  00253 064345        LDB SAVE     BUFFER ADDRESS 
  00254 044336        ADB VHO      START BUFFER AT HOR & VERT LINES 
  00255 160001  LOOP8 LDA 1,I      DATA POINT 
  00256 102600  OTA1  OTA 0        OUTPUT POINT TO SCOPE
  00257 006004        INB          BUMP BUFFER ADDRESS
  00260 002002        SZA          TEST FOR LAST WORD(0)
  00261 024255        JMP LOOP8    NEXT POINT 
  00262 024262        JMP *        WAIT FOR INTERRUPT 
* 
*ALIGHMENT TEST PATTERN DRIVER
*   OPERATING UNDER DMA CONTROL 
* 
  00002         DMAC1 EQU 2 
  00006         DMAD1 EQU 6 
  00263 107700  DMA2  CLC 0,C      NON-INTERRUPT
  00264 060301        LDA CW1      STC, CLC AND PACK DISABLED;D/A LOC 
  00265 102606        OTA DMAD1    OUTPUT CW1 TO DMA 1
  00266 106702        CLC DMAC1    PREPARE MEMORY ADDRESS REGISTER
  00267 060302        LDA CW2      MEMORY OUTPUT AND BUFFER START 
  00270 102602        OTA DMAC1    OUTPUT CW2 TO DMA 1
  00271 102702        STC DMAC1    PREPARE WORD COUNT REGISTER
  00272 060303        LDA CW3      2'S COMPLEMENT OF BUFFER LENGTH
  00273 102602        OTA DMAC1    OUTPUT CW3 TO DMA 1
  00274 103706        STC DMAD1,C  TURN ON DMA 1
  00275 102306        SFS DMAD1    DMA 1 OPERATION COMPLETE ? 
  00276 024275        JMP *-1        NO 
  00277 106706        CLC DMAD1    SHUT OFF DMA 1 
  00300 024230        JMP CHECK    OPTION CHECK BEFORE NEXT OUTPUT
* 
*PROGRAM CONSTANTS,COUNTERS,AND BUFFER STORAGE
* 
  00301 000000  CW1   NOP          DMA CONTROL WORD 
  00302 000346  CW2   OCT 346      DMA CONTROL WORD (MEMORY ADD.) 
  00303 175522  CW3   OCT 175522   DMA CONTROL WORD (WORD CNT.) 
  00304 102600  OTA   OCT 102600
  00305 103700  STCC  OCT 103700
  00306 070000  STA  OCT 070000 
  00307 177601  C127  DEC -127
  00310 177401  C255  DEC -255
  00311 177400  C256  DEC -256
  00312 000200  X5Y0  OCT 000200
  00313 100000  X0Y5  OCT 100000   CENTER LEFT POINT
  00314 000400  YLSB  OCT 000400
  00315 000040  VMARI OCT 000040  SPACING OF VERTICAL MARKS 
  00316 075400  VMAR  OCT 075400   FIRST POINT IN VERT MARK 
  00317 000000  MARK  NOP 
  00320 000000  MARKI NOP 
  00321 000000  MCNT  NOP          MARK COUNTER 
  00322 000000  PCNT  NOP         POINT COUNTER 
  00323 177770  MC    DEC -8          # MARKS PER LINE
  00324 177765  PC    DEC -11      POINTS PER MARK
  00325 000173  HMAR  OCT 000173   FIRST POINT IN HOR. MARK 
  00326 020000  HMARI OCT 020000
  00327 177776  VHCNT DEC -2
  00330 000000  VH    NOP 
  00331 100200  X5Y5  OCT 100200    CENTER POINT
  00332 177400  MYLSB OCT -400
  00333 177377  XYLSB OCT -000401 
  00334 177777  X9Y9  OCT 177777    UPPER RIGHT POINT 
  00335 000000  LAST  OCT 0        ZERO POINT(LOWER LEFT POINT) 
  00336 001256  VHO   DEC 686 
  00337 024230  TRAP  JMP CHECK 
  00340 000077  MASK  OCT 77
  00341 000000  LOC   OCT 0        I/O LOCATION CONTANT 
  00342 000000  NEXTM NOP 
  00343 000001  XLSB  OCT 1 
* 
*BUFFER STORAGE FOR DATA POINTS 
* 
*BUFFER STORAGE ALLOCATIONS 
*   1) MARKS=OCT 315 TO 574 
*   2) DIAGONAL(INSIDE OUT)=OCT 575 TO 1172 
*   3) DIAGONAL(TOP TO BOT LEFT)=OCT 1173 TO 1571 
*   4) VERTICAL LINE=OCT 1572 TO 2171 
*   5) HORIZONAL LINE=OCT 2172 TO 2571
*   6)  1  LOCATION FOR LAST POINT(000000)=OCT 2572 
* 
  00344 000346  STORE DEF BUFF        BUFFER ADDRESS COUNTER
  00345 000346  SAVE  DEF BUFF     SAVE FIRST ADDRESS OF BUFFER 
  00346         BUFF  BSS 1199     DATA POINT STORAGE 
                      END 
0 ERRORS
