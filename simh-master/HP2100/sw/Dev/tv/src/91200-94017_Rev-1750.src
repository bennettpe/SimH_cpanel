FTN4,L
      PROGRAM CHIN,3
C 
C  THIS PROGRAM IS DESIGNED TO DEMONSTRATE PROPER OPERATION 
C  OF THE HP 91200B-A02 TV MONITOR INTERFACE. 
C 
C  VERIFICATION ROUTINE "CHIN" DISPLAYS A MESSAGE IN CHINESE
C  CHARACTERS ON A TV MONITOR.
C 
C  RTE DRIVER DVA13 AND DRIVER LINK "DCTN" ARE REQUIRED TO
C  BE PRESENT IN THE SYSTEM. IN ADDITION, MICROPROGRAM "CCHR" 
C  MUST BE INSTALLED. 
C 
      DIMENSION ICCHA(108),IYCO(18),IXCO(18)
C 
C  DOT MATRIX DATA ARRAY
C 
      DATA ICCHA/2004B,1010B,7676B,1010B,420B,3434B,2424B,3434B,
     10,420B,1010B,2176B,5010B,10476B,20410B,40476B,410B,577B,
     210000B,10000B,10000B,10000B,17760B,11020B,21040B,41000B,
     31000B,1000B,1000B,1400B,1200B,1100B,1040B,2020B,4010B,30007B, 
     40,1003B,400B,200B,4,7707B,204B,404B,1004B,2000B,7700B,100B, 
     5200B,400B,1000B,2400B,4200B,70177B,0,76000B,20000B,20000B,
     620000B,77600B,20200B,20200B,20400B,20000B,20000B,20000B,
     720000B,20000B,20000B,20000B,20010B,77760B,34007B,34007B,
     834007B,34007B,34007B,34007B,34007B,37777B,37777B,37777B,
     934007B,34007B,34007B,34007B,34007B,34007B,34007B,34007B,
     A77770B,77770B,77770B,70070B,70070B,70070B,70070B,77770B,
     B77770B,77770B,70000B,70000B,70000B,70000B,70000B,70000B,
     C70000B,70000B/
C 
C  Y AXIS ORGIN ADDRESS ARRAY 
C 
      DATA IYCO/68,68,39,39,68,68,39,39,237,237,205,205,237,
     1237,205,205,138,138/
C 
C  X AXIS ORGIN ADDRESS ARRAY 
C 
      DATA IXCO/15,30,15,30,214,229,214,229,15,30,15,30,
     1214,229,214,229,107,130/
C 
C 
   10 WRITE (1,1000)
      READ (1,*) LU 
C 
   20 WRITE (1,1001)
      READ (1,*) ITEST
      IF (ITEST) 30,900,30
C 
C  ERASE SCREEN 
C 
   30 IE= LU+400B 
      CALL EXEC (3,IE)
      CALL EXEC (3,LU)
C 
C  OUTPUT MESSAGE TO TV MONITOR 
C 
      K= 1
      DO 200 I=1,16 
      CALL DCTN (ICCHA(K),IYCO(I),IXCO(I),LU) 
      K= K+18 
      IF (K-73) 200,100,100 
  100 K= 1
  200 CONTINUE
C 
      CALL DCTN (ICCHA(73),IYCO(17),IXCO(17),LU)
      CALL DCTN (ICCHA(91),IYCO(18),IXCO(18),LU)
      IF (ITEST-2) 20,30
C 
  900 CONTINUE
C 
 1000 FORMAT (/"* HP 91200B-A02 TV INTERFACE VERIFICATION *"//
     1"LOGICAL UNIT NO. ?  _")
 1001 FORMAT (/"  EXIT TEST   = 0"/"  TEST ONCE   = 1"/ 
     1"  LOOP ON TEST= 2"//"TEST OPTION NUMBER ?  _") 
C 
      END 
      END$
