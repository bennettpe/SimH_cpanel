10 PRINT "ROTATING TIE FIGHTER DEMO ON HP1351A GRAPHICS TRANSLATOR"
20 REM SET E$=CHR$(3)
21 LET E$="X"
22 CALL CHRS(3,E$)
30 PRINT #18;E$;":SN:SX:EM:EN:EX:UM:"

90 REM GENERATE 63 FILES WITH IMAGES WITH A0 RADIANS ROTATION
95 PRINT "FILE ";
100 FOR F=1 TO 63
105 PRINT F;".. ";
110 A0=(F-1)*3.14159/63
120 PRINT #18 USING 121;F
121       IMAGE "NF",2D,",:"
130 GOSUB 8000
140 PRINT #18 USING 141;F
141       IMAGE "BF",2D,",:"
150 NEXT F
155 PRINT "DONE"

190 REM BLANK/UNBLANK FILES TO ANIMATE ROTATION
192 PRINT "ANIMATE TIE FIGHTER ..."
193 PRINT "USE SWITCH 15 TO PAUSE ROTATION"
194 PRINT "    SWITCH 11 TO QUIT (WHILE PAUSED)"
195 PRINT "    SWITCHES 0 TO 4 TO CONTROLS THE SPEED"
199 D1=0
200 FOR F=1 TO 63
210 PRINT #18 USING 211;F-1,F
211       IMAGE "BF",2D,",:UF",2D,",:"
215 IF D1=0 GOTO 240
220 FOR D0=0 TO D1
221 REM LOSE SOME TIME
222 A1=F*F
223 NEXT D0
224 REM CHECK SWITCHES 
225 GOSUB 400
240 NEXT F
243 GOSUB 400
245 PRINT #18;"BF63,:" 
250 GOTO 200

390 REM CHECK PAUSE AND QUIT SWITCHES
400 IF SWR(11)>0 GOTO 500
410 IF SWR(15)>0 GOTO 400
415 REM CHECK ROTATION SPEED SWITCHES
420 D1=SWR(0)+SWR(1)*2+SWR(2)*8+SWR(3)*32+SWR(4)*128
430 RETURN

500 PRINT "TIE ROTATION TERMINATED"
510 GOTO 9999

8000 REM DRAW FRAME F ROTATED A0 RADIANS
8010 PRINT #18 USING 8011;F,E$
8011       IMAGE "PE0,:CS1,:PA10,900;:TX",2D,A,":"

8100 REM LEFT WING
8101 S9=0
8105 X0=500
8110 Y0=500
8120 Z=125
8130 RESTORE 8410
8140 GOSUB 9000

8150 REM RIGHT WING
8155 X0=500
8160 Y0=500
8170 Z=-125
8180 RESTORE 8410
8190 GOSUB 9000

8200 REM WINGS JUNCTION
8210 X0=500
8220 Y0=500
8230 Z=125
8240 RESTORE 8560
8250 GOSUB 9100

8300 REM COCKPIT
8305 X0=500
8310 Y0=500
8315 Z=0
8316 S9=0
8320 RESTORE 8510
8330 GOSUB 9000
8336 S9=1
8340 RESTORE 8510
8350 GOSUB 9000
8356 S9=2
8360 RESTORE 8510
8370 GOSUB 9000
8380 RETURN

8400 REM WING
8410 DATA 9000,0,  -100,0
8411 DATA 9001,0,  -50,200,  50,200,  100,0,  50,-200,  -50,-200,  -100,0
8412 DATA 0,0,     -50,200,  9000,0,  50,200, 9001,1,   0,0,        100,0
8413 DATA 9000,0,  50,-200,  9001,1,  0,0,    -50,-200, 9000,0
8414 DATA 20,0,    9001,1,   0,30,    -20,0,  0,-30,    20,0 
8415 DATA 9999,0

8500 REM COCKPIT
8510 DATA 9000,0,  50,0,  9001,0,  40,40,  0,60,  -40,40,  -50,0
8511 DATA -40,-40, 0,-60, 40,-40,  50,0
8512 DATA 9999,0

8550 REM WINGS JUNCTION
8560 DATA 20,0,  0,30,   -20,0,   0,-30,  9999,0

8800 X8=X9*COS(A0)-Z9*SIN(A0)
8810 Z8=X9*SIN(A0)+Z9*COS(A0)
8820 X9=X8
8825 Z9=Z8
8830 RETURN

9000 REM DRAW PLANE AT X0 Y0
9020 READ X,Y
9021 IF X=9000 PRINT #18;"PE0,:"
9022 IF X=9001 PRINT #18;"PE1,:"
9023 IF X=9999 RETURN
9024 IF X>=9000 GOTO 9020
9030 X9=X
9031 Y9=Y
9032 Z9=Z
9035 IF S9=1 GOTO 9041
9036 IF S9=2 GOTO 9046
9037 GOTO 9050
9041 T=Z9
9042 Z9=Y9
9043 Y9=T
9045 GOTO 9050
9046 T=X9
9047 X9=Z9
9049 Z9=T
9050 GOSUB 8800
9055 X1=X0-X9*0.6+Z9*0.6
9056 Y1=Y0+Y9-X9*0.3-Z9*0.3
9060 PRINT #18 USING 9061;X1,Y1
9061       IMAGE "PA",4D,",",4D,";:"
9070 GOTO 9020

9100 REM DRAW JUNCTION CENTERED AT X0 Y0
9120 READ X,Y
9130 IF X=9999 RETURN
9150 X9=X
9151 Y9=Y
9152 Z9=Z
9155 GOSUB 8800
9160 X1=X0-X9*0.6+Z9*0.6
9161 Y1=Y0+Y9-X9*0.3-Z9*0.3
9170 X9=X
9171 Y9=Y
9172 Z9=-Z
9175 GOSUB 8800
9180 X2=X0-X9*0.6+Z9*0.6
9181 Y2=Y0+Y9-X9*0.3-Z9*0.3
9190 PRINT #18 USING 9191;X1,Y1,X2,Y2
9191       IMAGE "PE0,:PA",4D,",",4D,";:PE1,:PA",4D,",",4D,";:"
9195 GOTO 9120

9999 END



