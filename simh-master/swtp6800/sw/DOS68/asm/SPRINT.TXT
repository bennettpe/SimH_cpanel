 TTL SERIAL PRINT SYSTEM
 OPT PAG,NOG
*
* GENERATE PRINTER DRIVER FOR USE BY THE P COMMAND
* THIS VERSION FOR SERIAL PRINTER ON PORT #3
*
* RUN FILE NAMED 'SPRINT.SYS' MUSTED BE PLACED ON
* SYSTEM/BOOT DISK TO BE RUN BY START.UP FILE
*
 ORG YPPORT PATCH PARAMETER TABLE PRINTER PORT
 FDB $800C PORT #3
*
* PATCH PARAMETER TABLE HARD COPY INITIALIZATION
*
 ORG ZHCINT
 JMP PINIT INITIALIZATION

* PATCH PARAMETER TABLE HARD COPY CHARACTER OUTPUT

 ORG ZHCOUT
 JMP PCHAR PRINTER CHARACTER OUTPUT
*
 ORG $A016 INTO SCRATCH PAD

PCHAR STX SAVEX SAVE IX & B
 PSHB
 LDX YPPORT GET PORT ADDRESS
LOOP LDAB #$02
 ANDB 0,X PRINTER READY
 BEQ LOOP NO - RETRY
 STAA 1,X YES - WRITE OUT CHAR
SAVEX EQU *+1
 LDX #SAVEX
 PULB
 RTS
*
 ORG $A04A SPLIT TO TOP OF SCRATCH

PINIT LDX YPPORT
 LDAB #$17 MASTER RESET
 STAB 0,X
 LDAB #$15 8 BIT - NO PARITY - 1 STOP BIT
 STAB 0,X
 RTS
*
 END PINIT
