



ASM/6800 1.4A0: 0000                    
08/16/82 00:00:00; Page 1; Form 1       
SWTBUG4000.ASM
                  1: ; * NAM SWTBUG
                  2: ; * VERSION 1.00
                  3: 
                  4: ; * OPT PAG
                  5: ; ****************************************************
                  6: ; * REPLACEMENT FOR MIKBUG ROM
                  7: ; * FOR SWTPC 6800 COMPUTER SYSTEM
                  8: ; * COPYRIGHT 1977
                  9: ; * SOUTHWEST TECHNICAL PROD. CORP.
                 10: ; * AUGUST, 1977
                 11: ; ****************************************************
                 12: ; * Modified by Roberto Sancho Jul/2022
                 13: ; * Relocated to assemble at $4000, ram at $4800, ACIA at $FF04
                 14: ; * to be used in Swtpc 64k hack to load SDOS at BE00-F000
                 15: ; * (regular swtbuf resides at E000 and is overwritten)
                 16: 
  4800           17:    ORG $4800
                 18:  
4800 0002        19: IRQ RMB 2               ; IRQ POINTER
4802 0002        20: BEGA RMB 2              ; BEGINNING ADDR PNCH
4804 0002        21: ENDA RMB 2              ; ENDING ADDR PNCH
4806 0002        22: NMI RMB 2               ; NMI INTERRUPT VECTOR
4808 0001        23: SP RMB 1                ; S HIGH
4809 0001        24:    RMB 1                ; S LOW
480A 0002        25: PORADD RMB 2            ; PORT ADDRESS
480C 0001        26: PORECH RMB 1            ; ECHO ON/OFF FLAG
480D 0001        27: XHI RMB 1               ; XREG HIGH
480E 0001        28: XLOW RMB 1              ; XREG LOW
480F 0001        29: CKSM RMB 1              ; CHECKSUM
4810 0002        30: XTEMP RMB 2             ; X-REG TEMP STGE
4812 0002        31: SWIJMP RMB 2            ; SWI JUMP VECTOR
  4844           32: TW EQU          $4844   ; TEMPORARY STORAGE
  4846           33: TEMP EQU        $4846   ; TEMPORARY STORAGE
  4847           34: BYTECT EQU      $4847   ; BYTECT AND MCONT TEMP.
  FF04           35: CTLPOR EQU      $FF04   ; CONTROL PORT ADDRESS
  C000           36: PROM EQU $C000          ; JUMP TO PROM ADDRESS
4814 0002        37: BKPT RMB 2              ; BREAKPOINT ADDRESS
4816 0001        38: BKLST RMB 1             ; BREAKPOINT DATA
                 39: 
  4842           40:  ORG $4842
                 41:  
4842 0001        42: STACK RMB 1     ; SWTBUG STACK
                 43: 
  4000           44:  ORG $4000
                 45: 
                 46: ; *I/O INTERRUPT SEQUENCE
4000 FE4800      47: IRQV LDX IRQ
4003 6E00        48:  JMP 0,X
                 49: 
                 50: ; *JUMP TO USER PROGRAM
4005 8D40        51: JUMP BSR BADDR
4007 6E00        52:  JMP 0,X
                 53: 
4009 101604      54: CURSOR FCB $10,$16,4 ; CT-1024 CURSOR CONTROL
                 55: 




ASM/6800 1.4A0: 4009                    
08/16/82 00:00:00; Page 2; Form 1       
SWTBUG4000.ASM
                 56: ; *ASCII LOADING ROUTINE
400C BD4334      57: LOAD JSR RDON   ; READER ON, DIS ECHO, GET P#
400F 8D67        58: LOAD3 BSR INCH
4011 8153        59:  CMPA #'S
4013 26FA        60:  BNE LOAD3      ; 1ST CHAR NOT S
4015 8D61        61:  BSR INCH       ; READ CHAR
4017 8139        62:  CMPA #'9
4019 2729        63:  BEQ LOAD21
401B 8131        64:  CMPA #'1
401D 26F0        65:  BNE LOAD3      ; 2ND CHAR NOT 1
401F 7F480F      66:  CLR CKSM       ; ZERO CHECKSUM
4022 8D31        67:  BSR BYTE       ; READ BYTE
4024 8002        68:  SUBA #2
4026 B74847      69:  STAA BYTECT    ; BYTE COUNT
                 70: ; *BUILD ADDRESS
4029 8D1C        71:  BSR BADDR
                 72: ; *STORE DATA
402B 8D28        73: LOAD11 BSR BYTE
402D 7A4847      74:  DEC BYTECT
4030 2709        75:  BEQ LOAD15     ; ZERO BYTE COUNT
4032 A700        76:  STAA 0,X       ; STORE DATA
4034 A100        77:  CMPA 0,X       ; DATA STORED?
4036 2608        78:  BNE LOAD19
4038 08          79:  INX
4039 20F0        80:  BRA LOAD11
403B 7C480F      81: LOAD15 INC CKSM
403E 27CF        82:  BEQ LOAD3
4040 863F        83: LOAD19 LDAA #'?
4042 8D31        84:  BSR OUTCH
4044 7E42D4      85: LOAD21 JMP RDOFF1
                 86: 
                 87: ; *BUILD ADDRESS
4047 8D0C        88: BADDR BSR BYTE  ; READ 2 FRAMES
4049 B7480D      89:  STAA XHI
404C 8D07        90:  BSR BYTE
404E B7480E      91:  STAA XLOW
4051 FE480D      92:  LDX XHI        ; LOAD IXR WITH NUMBER
4054 39          93:  RTS
                 94: 
                 95: ; *INPUT BYTE (TWO FRAMES)
4055 8D53        96: BYTE BSR INHEX  ; GET HEX CHAR
4057 48          97: BYTE1 ASLA
4058 48          98:  ASLA
4059 48          99:  ASLA
405A 48         100:  ASLA
405B 16         101:  TAB
405C 8D4C       102:  BSR INHEX
405E 1B         103:  ABA
405F 16         104:  TAB
4060 FB480F     105:  ADDB CKSM
4063 F7480F     106:  STAB CKSM
4066 39         107:  RTS
                108: 
4067 44         109: OUTHL LSRA      ; OUT HEX LEFT BCD DIGIT
4068 44         110:  LSRA




ASM/6800 1.4A0: 4069                    
08/16/82 00:00:00; Page 3; Form 1       
SWTBUG4000.ASM
4069 44         111:  LSRA
406A 44         112:  LSRA
406B 840F       113: OUTHR ANDA #$F  ; OUT HEX RIGHT BCD DIGIT
406D 8B30       114:  ADDA #$30
406F 8139       115:  CMPA #$39
4071 2302       116:  BLS OUTCH
4073 8B07       117:  ADDA #$7
                118: 
                119: ; *OUTPUT ONE CHAR
4075 7E41D1     120: OUTCH JMP OUTEEE
4078 7E41AC     121: INCH JMP INEEE
                122: 
                123: ; *PRINT DATA POINTED TO BY X REG
407B 8DF8       124: PDATA2 BSR OUTCH
407D 08         125:  INX
407E A600       126: PDATA1 LDAA 0,X
4080 8104       127:  CMPA #4
4082 26F7       128:  BNE PDATA2
4084 39         129:  RTS            ; STOP ON HEX 04
                130: 
4085 7E414A     131: C1 JMP SWTCTL
                132: 
                133: ; *MEMORY EXAMINE AND CHANGE
4088 8DBD       134: CHANGE BSR BADDR
408A CE419D     135: CHA51 LDX #MCL
408D 8DEF       136:  BSR PDATA1     ; C/R L/F
408F CE480D     137:  LDX #XHI
4092 8D34       138:  BSR OUT4HS     ; PRINT ADDRESS
4094 FE480D     139:  LDX XHI
4097 8D31       140:  BSR OUT2HS     ; PRINT OLD DATA
4099 8D31       141:  BSR OUTS       ; OUTPUT SPACE
409B 8DDB       142: ANOTH BSR INCH  ; INPUT CHAR
409D 8120       143:  CMPA #$20
409F 27FA       144:  BEQ ANOTH
40A1 810D       145:  CMPA #$D
40A3 27E0       146:  BEQ C1
40A5 815E       147:  CMPA #'^       ; UP ARROW?
40A7 202C       148:  BRA AL3        ; BRANCH FOR ADJUSTMENT
40A9 01         149:  NOP
                150: 
                151: ; *INPUT HEX CHARACTER
40AA 8DCC       152: INHEX BSR INCH
40AC 8030       153: INHEX1 SUBA #$30
40AE 2B4C       154:  BMI C3
40B0 8109       155:  CMPA #$9
40B2 2F0A       156:  BLE IN1HG
40B4 8111       157:  CMPA #$11
40B6 2B44       158:  BMI C3         ; NOT HEX
40B8 8116       159:  CMPA #$16
40BA 2E40       160:  BGT C3         ; NOT HEX
40BC 8007       161:  SUBA #7
40BE 39         162: IN1HG RTS
                163: 
40BF A600       164: OUT2H LDAA 0,X  ; OUTPUT 2 HEX CHAR
40C1 8DA4       165: OUT2HA BSR OUTHL ; OUT LEFT HEX CHAR




ASM/6800 1.4A0: 40C3                    
08/16/82 00:00:00; Page 4; Form 1       
SWTBUG4000.ASM
40C3 A600       166:  LDAA 0,X
40C5 08         167:  INX
40C6 20A3       168:  BRA OUTHR      ; OUTPUT RIGHT HEX CHAR
                169: 
40C8 8DF5       170: OUT4HS BSR OUT2H ; OUTPUT 4 HEX CHAR + SPACE
40CA 8DF3       171: OUT2HS BSR OUT2H ; OUTPUT 2 HEX CHAR + SPACE
                172: 
40CC 8620       173: OUTS LDAA #$20  ; SPACE
40CE 20A5       174:  BRA OUTCH      ; (BSR & TRS)
                175: 
                176: ; *ENTER POWER ON SEQUENCE
40D0 8E4842     177: START LDS #STACK
40D3 202C       178:  BRA AL1        ; BRANCH FOR ADDRESS COMPATIBIL
                179: 
                180: ; ********************************************
                181: ; *PART OF MEMORY EXAMINE AND CHANGE
40D5 2607       182: AL3 BNE SK1
40D7 09         183:  DEX
40D8 09         184:  DEX
40D9 FF480D     185:  STX XHI
40DC 20AC       186:  BRA CHA51
40DE FF480D     187: SK1 STX XHI
40E1 2002       188:  BRA AL4
                189: 
40E3 206D       190: EOE3 BRA CONTRL ; BRANCH FOR MIKBUG EQUIV. CONT
                191: 
40E5 8130       192: AL4 CMPA #$30
40E7 25A1       193:  BCS CHA51
40E9 8146       194:  CMPA #$46
40EB 229D       195:  BHI CHA51
40ED 8DBD       196:  BSR INHEX1
40EF BD4057     197:  JSR BYTE1
40F2 09         198:  DEX
40F3 A700       199:  STAA 0,X       ; CHANGE MEMORY
40F5 A100       200:  CMPA 0,X
40F7 2791       201:  BEQ CHA51      ; DID CHANGE
40F9 7E4040     202:  JMP LOAD19     ; DIDN'T CHANGE
40FC BE4808     203: C3 LDS SP
40FF 2049       204:  BRA SWTCTL
                205: ; **************************************************
                206: 
                207: ; *CONTINUE POWER UP SEQUENCE
4101 BF4808     208: AL1 STS SP      ; INIT TARGET STACK PTR.
4104 86FF       209:  LDAA #$FF
4106 BD4308     210:  JSR SWISET
                211: ; *CONFIGURE FOR PIA AND SEE IF OK
4109 CEFF04     212:  LDX #CTLPOR
410C BD4284     213:  JSR PIAINI     ; INIT PIA
410F A600       214:  LDAA 0,X
4111 A102       215:  CMPA 2,X
4113 2002       216:  BRA AL2
                217: 
4115 2019       218:  BRA PRINT      ; BRA FOR BILOAD
                219: 
4117 2639       220: AL2 BNE CONTRL




ASM/6800 1.4A0: 4117                    
08/16/82 00:00:00; Page 5; Form 1       
SWTBUG4000.ASM
                221: 
                222: ; *INITIALIZE AS ACIA
4119 8603       223:  LDAA #3        ; ACIA MASTER RESET
411B A700       224:  STAA 0,X
411D 8611       225:  LDAA #$11
411F A700       226:  STAA 0,X
4121 202F       227:  BRA CONTRL
                228: 
                229: ; *ENTER FROM SOFTWARE INTERRUPT
4123 01         230: SF0 NOP
4124 BF4808     231: SFE1 STS SP     ; SAVE TARGETS STACK POINTER
                232: ; *DECREMENT P COUNTER
4127 30         233:  TSX
4128 6D06       234:  TST 6,X
412A 2602       235:  BNE *+4
412C 6A05       236:  DEC 5,X
412E 6A06       237:  DEC 6,X
                238: ; *PRINT CONTENTS OF STACK.
4130 CE419D     239: PRINT LDX #MCL
4133 BD407E     240:  JSR PDATA1
4136 FE4808     241:  LDX SP
4139 08         242:  INX
413A 8D8E       243:  BSR OUT2HS     ; COND CODES
413C 8D8C       244:  BSR OUT2HS     ; ACC B
413E 8D8A       245:  BSR OUT2HS     ; ACC A
4140 8D86       246:  BSR OUT4HS     ; IXR
4142 8D84       247:  BSR OUT4HS     ; PGM COUNTER
4144 CE4808     248:  LDX #SP
4147 BD40C8     249:  JSR OUT4HS     ; STACK POINTER
414A FE4812     250: SWTCTL LDX SWIJMP
414D 8C4123     251:  CPX #SF0
4150 2719       252:  BEQ CONTR1
                253: 
4152 8E4842     254: CONTRL LDS #STACK ; SET CONTRL STACK POINTER
4155 CEFF04     255:  LDX #CTLPOR    ; RESET TO CONTROL PORT
4158 FF480A     256:  STX PORADD
415B 7F480C     257:  CLR PORECH     ; TURN ECHO ON
415E 8D73       258:  BSR SAVGET     ; GET PORT # AND TYPE
4160 2703       259:  BEQ POF1
4162 BD427D     260:  JSR PIAECH     ; SET PIA ECHO ON IF MP-C INTER
4165 BD4353     261: POF1 JSR PNCHOF ; TURN PUNCH OFF
4168 BD4347     262:  JSR RDOFF      ; TURN READER OFF
416B CE419C     263: CONTR1 LDX #MCLOFF
416E BD407E     264:  JSR PDATA1     ; PRINT DATA STRING
4171 8D39       265:  BSR INEEE      ; READ COMMAND CHARACTER
                266: 
                267: ; *COMMAND LOOKUP ROUTINE
4173 CE43D1     268: LOOK LDX #TABLE
4176 A100       269: OVER CMPA 0,X
4178 2607       270:  BNE SK3
417A BD40CC     271:  JSR OUTS       ; SKIP SPACE
417D EE01       272:  LDX 1,X
417F 6E00       273:  JMP 0,X
4181 08         274: SK3 INX
4182 08         275:  INX




ASM/6800 1.4A0: 4183                    
08/16/82 00:00:00; Page 6; Form 1       
SWTBUG4000.ASM
4183 08         276:  INX
4184 8C43F8     277:  CPX #TABEND+3
4187 26ED       278:  BNE OVER
4189 20BF       279: SWTL1 BRA SWTCTL
                280: 
                281: ; *SOFTWARE INTERRUPT ENTRY POINT
418B FE4812     282: SFE LDX SWIJMP  ; JUMP TO VECTORED SOFTWARE INT
418E 6E00       283:  JMP 0,X
                284: 
4190 533904     285: S9 FCB 'S,'9,4  ; END OF TAPE
                286: 
                287: ; ***************************************************
4193 0D0A1500   288: MTAPE1 FCB $D,$A,$15,0,0,0,'S,'1,4 ; PUNCH FORMAT
                289: 
419C 13         290: MCLOFF FCB $13 ; READER OFF
419D 0D0A1500   291: MCL FCB $D,$A,$15,0,0,0,'$,4
                292: 
41A5 204C       293: EIA5 BRA BILD   ; BINARY LOADER INPUT
                294: ; ***************************************************
                295: 
                296: 
                297: ; *NMI SEQUENCE
41A7 FE4806     298: NMIV LDX NMI    ; GET NMI VECTOR
41AA 6E00       299:  JMP 0,X
                300: 
41AC 2040       301: INEEE BRA INEEE1
                302: 
                303: ; *BYTE SEARCH ROUTINE
41AE BD4047     304: SEARCH JSR BADDR ; GET TOP ADDRESS
41B1 FF4804     305:  STX ENDA
41B4 BD4047     306:  JSR BADDR      ; GET BOTTOM ADDRESS
41B7 BD4055     307:  JSR BYTE       ; GET BYTE TO SEARCH FOR
41BA 16         308:  TAB
41BB A600       309: OVE LDAA 0,X
41BD FF480D     310:  STX XHI
41C0 11         311:  CBA
41C1 2702       312:  BEQ PNT
41C3 2021       313:  BRA INCR1
41C5 CE419D     314: PNT LDX #MCL
41C8 BD407E     315:  JSR PDATA1
41CB CE480D     316:  LDX #XHI
41CE 2010       317:  BRA SKP0
                318: ; ***************************************************
                319: 
                320: ; *GO TO USER PROGRAM ROUTINE
41D0 3B         321: GOTO RTI
41D1 203A       322: OUTEEE BRA OUTEE1
                323: 
                324: 
                325: 
                326: ; *SAVE IXR AND LOAD IXR WITH CORRECT
                327: ; *PORT NUMBER AND TEST FOR TYPE
41D3 FF4810     328: SAVGET STX XTEMP ; STORE INDEX REGISTER
41D6 FE480A     329: GETPT1 LDX PORADD
41D9 37         330: ISACIA PSHB




ASM/6800 1.4A0: 41DA                    
08/16/82 00:00:00; Page 7; Form 1       
SWTBUG4000.ASM
41DA E601       331:  LDAB 1,X
41DC E103       332:  CMPB 3,X
41DE 33         333:  PULB
41DF 39         334:  RTS
                335: ; ***************************************************
                336: 
                337: ; *CONTINUATION OF SEARCH ROUTINE
41E0 BD40C8     338: SKP0 JSR OUT4HS
41E3 FE480D     339:  LDX XHI
41E6 BC4804     340: INCR1 CPX ENDA
41E9 279E       341:  BEQ SWTL1
41EB 08         342:  INX
41EC 20CD       343:  BRA OVE
                344: 
41EE 8D06       345: INEEE1 BSR INCH8 ; INPUT 8 BIT CHARACTER
41F0 847F       346:  ANDA #%01111111 ; GET RID OF PARITY BIT
41F2 39         347:  RTS
                348: 
41F3 31         349: BILD INS        ; FIX UP STACK WHEN USING
41F4 31         350:  INS            ; BINARY LOADER ON SWTPC TAPES
41F5 31         351:  INS
                352: 
                353: ; *INPUT ONE CHAR INTO ACC B
41F6 37         354: INCH8 PSHB      ; SAVE ACC B
41F7 8DDA       355:  BSR SAVGET     ; SAVE IXR, GET PORT# AND TYPE
41F9 2628       356:  BNE IN1        ; INPUT FROM PIA IF NOT
41FB 8615       357:  LDAA #$15      ; RECONFIG FOR 8 BIT, 1 SB
41FD A700       358:  STAA 0,X
41FF A600       359: ACIAIN LDAA 0,X
4201 47         360:  ASRA
4202 24FB       361:  BCC ACIAIN     ; NOT READY
4204 A601       362:  LDAA 1,X       ; LOAD CHAR
4206 F6480C     363:  LDAB PORECH
4209 2707       364:  BEQ ACIOUT     ; ECHO
420B 2011       365:  BRA RES        ; DON'T ECHO
                366: 
                367: ; *OUTPUT ONE CHARACTER
420D 37         368: OUTEE1 PSHB     ; SAVE ACC B
420E 8DC3       369:  BSR SAVGET
4210 262E       370:  BNE IOUT
                371: 
4212 C611       372: ACIOUT LDAB #$11
4214 E700       373:  STAB 0,X
4216 E600       374: ACIOU1 LDAB 0,X
4218 57         375:  ASRB
4219 57         376:  ASRB
421A 24FA       377:  BCC ACIOU1     ; ACIA NOT READY
421C A701       378:  STAA 1,X       ; OUTPUT CHARACTER
421E 33         379: RES PULB        ; RESTORE ACC B
421F FE4810     380:  LDX XTEMP
4222 39         381:  RTS
                382: 
                383: ; *PIA INPUT ROUTINE
4223 A600       384: IN1 LDAA 0,X    ; LOOK FOR START BIT
4225 2BFC       385:  BMI IN1




ASM/6800 1.4A0: 4227                    
08/16/82 00:00:00; Page 8; Form 1       
SWTBUG4000.ASM
4227 8D3A       386:  BSR DDL        ; DELAY HALF BIT TIME
4229 C604       387:  LDAB #4        ; SET DEL FOR FULL BIT TIME
422B E702       388:  STAB 2,X
422D 58         389:  ASLB           ; SET UP CNTR WITH 8
422E 8D2A       390: IN3 BSR DEL     ; WAIT ONE CHAR TIME
4230 0D         391:  SEC
4231 6900       392:  ROL 0,X
4233 46         393:  RORA
4234 5A         394:  DECB
4235 26F7       395:  BNE IN3
4237 8D21       396:  BSR DEL        ; WAIT FOR STOP BIT
4239 F6480C     397:  LDAB PORECH    ; IS ECHO DESIRED?
423C 2713       398:  BEQ IOUT2      ; ECHO
423E 20DE       399:  BRA RES        ; RESTORE IXR,ACCB
                400: ; *PIA OUTPUT ROUTINE
4240 8D23       401: IOUT BSR DDL1   ; DELAY ONE HALF BIT TIME
4242 C60A       402:  LDAB #$A       ; SET UP COUNTER
4244 6A00       403:  DEC 0,X        ; SET START BIT
4246 8D16       404:  BSR DE         ; START TIMER
4248 8D10       405: OUT1 BSR DEL    ; DELAY ONE BIT TIME
424A A700       406:  STAA 0,X       ; PUT OUT ONE DATA BIT
424C 0D         407:  SEC
424D 46         408:  RORA           ; SHIFT IN NEXT BIT
424E 5A         409:  DECB           ; DECREMENT COUNTER
424F 26F7       410:  BNE OUT1       ; TEST FOR 0
4251 E602       411: IOUT2 LDAB 2,X  ; TEST FOR STOP BITS
4253 58         412:  ASLB           ; SHIFT BIT TO SIGN
4254 2AC8       413:  BPL RES        ; BRA FOR 1 STOP BIT
4256 8D02       414:  BSR DEL        ; DELAY FOR STOP BITS
4258 20C4       415:  BRA RES
425A 6D02       416: DEL TST 2,X     ; IS TIME UP
425C 2AFC       417:  BPL DEL
425E 6C02       418: DE INC 2,X      ; RESET TIMER
4260 6A02       419:  DEC 2,X
4262 39         420:  RTS
                421: 
4263 6F02       422: DDL CLR 2,X     ; HALF BIT DELAY
4265 8DF7       423: DDL1 BSR DE
4267 20F1       424:  BRA DEL
                425: 
                426: 
                427: ; *OPTIONAL PORT ROUTINE
4269 8D83       428: OPTL BSR INEEE1
426B 16         429:  TAB
426C 7F480B     430:  CLR PORADD+1   ; SET I/O ADDRESS FOR $8000
426F FE480A     431:  LDX PORADD
4272 8D10       432:  BSR PIAINI     ; INITIALIZE PIA
4274 8D07       433:  BSR PIAECH     ; SET ECHO
4276 CE43EF     434:  LDX #TABLE1    ; P, L OR E
4279 17         435:  TBA
427A 7E4176     436:  JMP OVER       ; LOOK AT TABLE FOR E, L OR P
                437: 
427D 8634       438: PIAECH LDAA #$34 ; SET DDR
427F A703       439:  STAA 3,X
4281 A702       440:  STAA 2,X




ASM/6800 1.4A0: 4283                    
08/16/82 00:00:00; Page 9; Form 1       
SWTBUG4000.ASM
4283 39         441: NOOPT RTS
                442: 
                443: ; *PIA INITIALIZATION ROUTINE
4284 6C00       444: PIAINI INC 0,X  ; SET DDR
4286 8607       445:  LDAA #$7
4288 A701       446:  STAA 1,X
428A 6C00       447:  INC 0,X
428C A702       448:  STAA 2,X
428E 39         449:  RTS
                450: 
                451: ; *MINIFLOPPY DISK BOOT
428F 7F8014     452: DISK CLR $8014
4292 8D2E       453:  BSR DELAY
4294 C60B       454:  LDAB #$0B
4296 8D25       455:  BSR RETT2
4298 E604       456: LOOP1 LDAB 4,X
429A C501       457:  BITB #1
429C 26FA       458:  BNE LOOP1
429E 6F06       459:  CLR 6,X
42A0 8D1D       460:  BSR RETURN
42A2 C69C       461:  LDAB #$9C
42A4 8D17       462:  BSR RETT2
42A6 CE2400     463:  LDX #$2400
42A9 C502       464: LOOP2 BITB #2
42AB 2706       465:  BEQ LOOP3
42AD B6801B     466:  LDAA $801B
42B0 A700       467:  STAA 0,X
42B2 08         468:  INX
42B3 F68018     469: LOOP3 LDAB $8018
42B6 C501       470:  BITB #1
42B8 26EF       471:  BNE LOOP2
42BA 7E2400     472:  JMP $2400
42BD E704       473: RETT2 STAB 4,X
42BF 8D00       474: RETURN BSR RETT1
42C1 39         475: RETT1 RTS
                476: 
                477: ; *GENERAL PURPOSE DELAY LOOP
42C2 CEFFFF     478: DELAY LDX #$FFFF
42C5 09         479: DELAY1 DEX
42C6 8C8014     480:  CPX #$8014     ; STOP AT 8014
42C9 26FA       481: DUM BNE DELAY1
42CB 39         482:  RTS
                483: 
                484: 
                485: ; *CLRAR SCREEN FOR CT-1024 TYPE TERMINALS
42CC CE4009     486: CLEAR LDX #CURSOR
42CF BD407E     487:  JSR PDATA1
42D2 8DF1       488:  BSR DELAY1     ; DELAY
42D4 BD4347     489: RDOFF1 JSR RDOFF
42D7 2058       490:  BRA C4
                491: 
                492: ; *BREAKPOINT ENTERING ROUTINE
42D9 CE4123     493: BREAK LDX #SF0
42DC BC4812     494:  CPX SWIJMP     ; BREAKPOINTS ALREADY IN USE?
42DF 271A       495:  BEQ INUSE




ASM/6800 1.4A0: 42E1                    
08/16/82 00:00:00; Page 10; Form 1      
SWTBUG4000.ASM
42E1 08         496:  INX
42E2 8D32       497: BREAK0 BSR STO1
42E4 BD4047     498:  JSR BADDR
42E7 FF4814     499:  STX BKPT
42EA A600       500:  LDAA 0,X
42EC B74816     501:  STAA BKLST
42EF 863F       502:  LDAA #$3F
42F1 A700       503:  STAA 0,X
42F3 CE4123     504:  LDX #SF0
42F6 8D1E       505:  BSR STO1
42F8 7E416B     506:  JMP CONTR1
42FB FE4814     507: INUSE LDX BKPT
42FE B64816     508:  LDAA BKLST
4301 A700       509:  STAA 0,X
4303 CE4124     510:  LDX #SFE1
4306 20DA       511:  BRA BREAK0
                512: 
4308 B74843     513: SWISET STAA STACK+1 ; FIX POWER UP INTERRUPT
430B FE4812     514:  LDX SWIJMP
430E 8C4123     515:  CPX #SF0
4311 2706       516:  BEQ STORTN
4313 CE4124     517: STO LDX #SFE1
4316 FF4812     518: STO1 STX SWIJMP
4319 39         519: STORTN RTS
                520: 
431A 8D5A       521: PUNCH1 BSR PUNCH
431C 200F       522:  BRA POFC4
                523: 
                524: ; *FORMAT END OF TAPE WITH PGM. CTR. AND S9
431E CEA049     525: PNCHS9 LDX #$A049
4321 FF4804     526:  STX ENDA
4324 09         527:  DEX
4325 8D52       528:  BSR PUNCH2
4327 CE4190     529:  LDX #S9
432A BD407E     530: PDAT JSR PDATA1
432D 8D24       531: POFC4 BSR PNCHOF
432F 8D91       532:  BSR DELAY
4331 7E4152     533: C4 JMP CONTRL
                534: 
4334 73480C     535: RDON COM PORECH ; DISABLE ECHO FOR ACIA
4337 8611       536:  LDAA #$11      ; RON CHAR.
4339 C620       537:  LDAB #$20      ; STROBE CHAR
433B 8D1A       538:  BSR STROBE
433D BD41D9     539:  JSR ISACIA     ; CHECK TO SEE IF PIA
4340 2704       540:  BEQ RTNN
4342 863C       541:  LDAA #$3C      ; DISABLE PIA ECHO IF PIA
4344 A703       542:  STAA 3,X
4346 39         543: RTNN RTS
                544: 
4347 8613       545: RDOFF LDAA #$13 ; TURN READER OFF
4349 C610       546:  LDAB #$10
434B 200A       547:  BRA STROBE
                548: 
434D 8612       549: PNCHON LDAA #$12
434F C604       550:  LDAB #4




ASM/6800 1.4A0: 4351                    
08/16/82 00:00:00; Page 11; Form 1      
SWTBUG4000.ASM
4351 2004       551:  BRA STROBE
                552: 
4353 8614       553: PNCHOF LDAA #$14
4355 C608       554:  LDAB #$8
                555: 
                556: ; *PIA STROBING ROUTINE FOR PUNCH/READ ON/OFF
4357 BD4075     557: STROBE JSR OUTCH
435A BD41D6     558:  JSR GETPT1
435D 2716       559:  BEQ RTN1
435F 8602       560:  LDAA #2
4361 CA01       561:  ORAB #1
4363 8D0C       562:  BSR STR2
4365 8D08       563:  BSR STR1
4367 8602       564:  LDAA #2
4369 C601       565:  LDAB #1
436B E700       566:  STAB 0,X
436D 8D02       567:  BSR STR2
436F 8606       568: STR1 LDAA #6
4371 A701       569: STR2 STAA 1,X
4373 E700       570:  STAB 0,X
4375 39         571: RTN1 RTS
                572: 
                573: ; *PUNCH FROM BEGINNING ADDRESS (BEGA) THRU
                574: ; *ENDING ADDRESS (ENDA)
4376 FE4802     575: PUNCH LDX BEGA
4379 FF4844     576: PUNCH2 STX TW
437C 8DCF       577:  BSR PNCHON
437E B64805     578: PUN11 LDAA ENDA+1
4381 B04845     579:  SUBA TW+1
4384 F64804     580:  LDAB ENDA
4387 F24844     581:  SBCB TW
438A 2604       582:  BNE PUN22
438C 8110       583:  CMPA #16
438E 2502       584:  BCS PUN23
4390 860F       585: PUN22 LDAA #15
4392 8B04       586: PUN23 ADDA #4
4394 B74847     587:  STAA BYTECT
4397 8003       588:  SUBA #3
4399 B74846     589:  STAA TEMP
                590: ; *PUNCH C/R L/F NULLS S1
439C CE4193     591:  LDX #MTAPE1
439F BD407E     592:  JSR PDATA1
43A2 5F         593:  CLRB
                594: ; *PUNCH FRAME COUNT
43A3 CE4847     595:  LDX #BYTECT
43A6 8D24       596:  BSR PUNT2      ; PUNCH 2 HEX CHARACTERS
                597: ; *PUNCH ADDRESS
43A8 CE4844     598:  LDX #TW
43AB 8D1F       599:  BSR PUNT2
43AD 8D1D       600:  BSR PUNT2
                601: ; *PUNCH DATA
43AF FE4844     602:  LDX TW
43B2 8D18       603: PUN32 BSR PUNT2 ; PUNCH ONE BYTE
43B4 7A4846     604:  DEC TEMP
43B7 26F9       605:  BNE PUN32




ASM/6800 1.4A0: 43B9                    
08/16/82 00:00:00; Page 12; Form 1      
SWTBUG4000.ASM
43B9 FF4844     606:  STX TW
43BC 53         607:  COMB
43BD 37         608:  PSHB
43BE 30         609:  TSX
43BF 8D0B       610:  BSR PUNT2      ; PUNCH CHECKSUM
43C1 33         611:  PULB           ; RESTORE STACK
43C2 FE4844     612:  LDX TW
43C5 09         613:  DEX
43C6 BC4804     614:  CPX ENDA
43C9 26B3       615:  BNE PUN11
43CB 39         616: RTN5 RTS
                617: 
                618: ; *PUNCH 2 HEX CHAR, UPDATE CHECKSUM
43CC EB00       619: PUNT2 ADDB 0,X
43CE 7E40BF     620:  JMP OUT2H      ; OUTPUT 2 HEX CHAR AND RTS
                621: 
                622: ; *COMMAND TABLE
43D1 47         623: TABLE FCB 'G    ; GOTO
43D2 41D0       624:  FDB GOTO
43D4 5A         625:  FCB 'Z         ;GOTO PROM
43D5 C000       626:  FDB PROM
43D7 4D         627:  FCB 'M         ; MEMORY EXAM AND CHANGE
43D8 4088       628:  FDB CHANGE
43DA 46         629:  FCB 'F         ; BYTE SEARCH
43DB 41AE       630:  FDB SEARCH
43DD 52         631:  FCB 'R         ; REGISTER DUMP
43DE 4130       632:  FDB PRINT
43E0 4A         633:  FCB 'J         ; JUMP
43E1 4005       634:  FDB JUMP
43E3 43         635:  FCB 'C         ; CLEAR SCREEN
43E4 42CC       636:  FDB CLEAR
43E6 44         637:  FCB 'D         ; DISK BOOT
43E7 428F       638:  FDB DISK
43E9 42         639:  FCB 'B         ; BREAKPOINT
43EA 42D9       640:  FDB BREAK
43EC 4F         641:  FCB 'O         ; OPTIONAL PORT
43ED 4269       642:  FDB OPTL
43EF 50         643: TABLE1 FCB 'P   ; ASCII PUNCH
43F0 431A       644:  FDB PUNCH1
43F2 4C         645:  FCB 'L         ; ASCII LOAD
43F3 400C       646:  FDB LOAD
43F5 45         647: TABEND FCB 'E   ; END OF TAPE
43F6 431E       648:  FDB PNCHS9
                649: 
  43F8          650:  ORG $43F8
43F8 4000       651:  FDB IRQV       ; IRQ VECTOR
43FA 418B       652:  FDB SFE        ; SOFTWARE INTERRUPT
43FC 41A7       653:  FDB NMIV       ; NMI VECTOR
43FE 40D0       654:  FDB START      ; RESTART VECTOR
                655: 
                656:  ; autostart relocated SWTBUG when loaded form regular SWTBUG
  A048          657:  ORG $A048
A048 40D0       658:  FDB START
                659:  END




ASM/6800 1.4A0: A048                    
08/16/82 00:00:00; Page 13; Form 1      Symbols Sorted by Name
SWTBUG4000.ASM
Symbols Sorted by Name:

 ACIAIN/41FF     ACIOU1/4216     ACIOUT/4212     AL1/4101        AL2/4117        AL3/40D5        AL4/40E5        ANOTH/409B
 BADDR/4047      BEGA/4802       BILD/41F3       BKLST/4816      BKPT/4814       BREAK/42D9      BREAK0/42E2     BYTE/4055
 BYTE1/4057      BYTECT/4847     C1/4085         C3/40FC         C4/4331         CHA51/408A      CHANGE/4088     CKSM/480F
 CLEAR/42CC      CONTR1/416B     CONTRL/4152     CTLPOR/FF04     CURSOR/4009     DDL/4263        DDL1/4265       DE/425E
 DEL/425A        DELAY/42C2      DELAY1/42C5     DISK/428F      *DUM/42C9       *EIA5/41A5       ENDA/4804      *EOE3/40E3
 GETPT1/41D6     GOTO/41D0       IN1/4223        IN1HG/40BE      IN3/422E        INCH/4078       INCH8/41F6      INCR1/41E6
 INEEE/41AC      INEEE1/41EE     INHEX/40AA      INHEX1/40AC     INUSE/42FB      IOUT/4240       IOUT2/4251      IRQ/4800
 IRQV/4000       ISACIA/41D9     JUMP/4005       LOAD/400C       LOAD11/402B     LOAD15/403B     LOAD19/4040     LOAD21/4044
 LOAD3/400F     *LOOK/4173       LOOP1/4298      LOOP2/42A9      LOOP3/42B3     *M6800/0001     *M6801/0000     *M6809/0000
 MCL/419D        MCLOFF/419C     MTAPE1/4193     NMI/4806        NMIV/41A7      *NOOPT/4283      OPTL/4269       OUT1/4248
 OUT2H/40BF     *OUT2HA/40C1     OUT2HS/40CA     OUT4HS/40C8     OUTCH/4075      OUTEE1/420D     OUTEEE/41D1     OUTHL/4067
 OUTHR/406B      OUTS/40CC       OVE/41BB        OVER/4176      *PDAT/432A       PDATA1/407E     PDATA2/407B     PIAECH/427D
 PIAINI/4284     PNCHOF/4353     PNCHON/434D     PNCHS9/431E     PNT/41C5        POF1/4165       POFC4/432D      PORADD/480A
 PORECH/480C     PRINT/4130      PROM/C000       PUN11/437E      PUN22/4390      PUN23/4392      PUN32/43B2      PUNCH/4376
 PUNCH1/431A     PUNCH2/4379     PUNT2/43CC      RDOFF/4347      RDOFF1/42D4     RDON/4334       RES/421E        RETT1/42C1
 RETT2/42BD      RETURN/42BF     RTN1/4375      *RTN5/43CB       RTNN/4346       S9/4190         SAVGET/41D3     SEARCH/41AE
 SF0/4123        SFE/418B        SFE1/4124       SK1/40DE        SK3/4181        SKP0/41E0       SP/4808         STACK/4842
 START/40D0     *STO/4313        STO1/4316       STORTN/4319     STR1/436F       STR2/4371       STROBE/4357     SWIJMP/4812
 SWISET/4308     SWTCTL/414A     SWTL1/4189      TABEND/43F5     TABLE/43D1      TABLE1/43EF     TEMP/4846       TW/4844
 XHI/480D        XLOW/480E       XTEMP/4810




ASM/6800 1.4A0: A048                    
08/16/82 00:00:00; Page 14; Form 1      Symbols Sorted by Value
SWTBUG4000.ASM
Symbols Sorted by Value:

*M6801/0000     *M6809/0000     *M6800/0001      IRQV/4000       JUMP/4005       CURSOR/4009     LOAD/400C       LOAD3/400F
 LOAD11/402B     LOAD15/403B     LOAD19/4040     LOAD21/4044     BADDR/4047      BYTE/4055       BYTE1/4057      OUTHL/4067
 OUTHR/406B      OUTCH/4075      INCH/4078       PDATA2/407B     PDATA1/407E     C1/4085         CHANGE/4088     CHA51/408A
 ANOTH/409B      INHEX/40AA      INHEX1/40AC     IN1HG/40BE      OUT2H/40BF     *OUT2HA/40C1     OUT4HS/40C8     OUT2HS/40CA
 OUTS/40CC       START/40D0      AL3/40D5        SK1/40DE       *EOE3/40E3       AL4/40E5        C3/40FC         AL1/4101
 AL2/4117        SF0/4123        SFE1/4124       PRINT/4130      SWTCTL/414A     CONTRL/4152     POF1/4165       CONTR1/416B
*LOOK/4173       OVER/4176       SK3/4181        SWTL1/4189      SFE/418B        S9/4190         MTAPE1/4193     MCLOFF/419C
 MCL/419D       *EIA5/41A5       NMIV/41A7       INEEE/41AC      SEARCH/41AE     OVE/41BB        PNT/41C5        GOTO/41D0
 OUTEEE/41D1     SAVGET/41D3     GETPT1/41D6     ISACIA/41D9     SKP0/41E0       INCR1/41E6      INEEE1/41EE     BILD/41F3
 INCH8/41F6      ACIAIN/41FF     OUTEE1/420D     ACIOUT/4212     ACIOU1/4216     RES/421E        IN1/4223        IN3/422E
 IOUT/4240       OUT1/4248       IOUT2/4251      DEL/425A        DE/425E         DDL/4263        DDL1/4265       OPTL/4269
 PIAECH/427D    *NOOPT/4283      PIAINI/4284     DISK/428F       LOOP1/4298      LOOP2/42A9      LOOP3/42B3      RETT2/42BD
 RETURN/42BF     RETT1/42C1      DELAY/42C2      DELAY1/42C5    *DUM/42C9        CLEAR/42CC      RDOFF1/42D4     BREAK/42D9
 BREAK0/42E2     INUSE/42FB      SWISET/4308    *STO/4313        STO1/4316       STORTN/4319     PUNCH1/431A     PNCHS9/431E
*PDAT/432A       POFC4/432D      C4/4331         RDON/4334       RTNN/4346       RDOFF/4347      PNCHON/434D     PNCHOF/4353
 STROBE/4357     STR1/436F       STR2/4371       RTN1/4375       PUNCH/4376      PUNCH2/4379     PUN11/437E      PUN22/4390
 PUN23/4392      PUN32/43B2     *RTN5/43CB       PUNT2/43CC      TABLE/43D1      TABLE1/43EF     TABEND/43F5     IRQ/4800
 BEGA/4802       ENDA/4804       NMI/4806        SP/4808         PORADD/480A     PORECH/480C     XHI/480D        XLOW/480E
 CKSM/480F       XTEMP/4810      SWIJMP/4812     BKPT/4814       BKLST/4816      STACK/4842      TW/4844         TEMP/4846
 BYTECT/4847     PROM/C000       CTLPOR/FF04

155 Symbols.


 *** No Assembly Errors.
